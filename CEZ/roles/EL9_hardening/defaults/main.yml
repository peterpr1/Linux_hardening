---
# Definition of the environment for which the server is configured.
# This value affects the default configurations for selected services.
# Available options are listed in the "ENVIRONMENTS_LIST" variable.
# If a non-existent environment is entered here, it will default to "CEZ".
SERVER_ENVIRONMENT: "CEZ"


# List of available environments. The script uses this to verify the correctness of the "SERVER_ENVIRONMENT" variable.
ENVIRONMENTS_LIST:
  - "CEZ"
  - "P2_PROD"
  - "P2_TEST"
  - "P2_EVA"
  - "P4_PROD"
  - "P4_TEST"
  - "P4_EVA"
  - "COPD_PROD"
  - "COPD_TEST"
  - "COPD_EVA"
  - "COPD_ACC"
  - "ZOPD_PROD"
  - "ZOPD_TEST"
  - "ZOPD_EVA"
  - "ZOPD_ACC"


# Switches defining whether the script should set default values for specific services, based on the selected environment.
# By default, the script will only verify the configurations for the selected services.
# Setting the value to "true" will cause the script to configure the service with default values.
CONFIGURE_NTP: true
CONFIGURE_PROXY: false
CONFIGURE_ZABBIX: false

# This variable is used in a pre task, handling grub2 paths either in case of
# UEFI boot('/etc/grub2-efi.cfg') or in case of BIOS legacy-boot('/etc/grub2.cfg').
rhel9cis_legacy_boot: false

#================================================================================================================
##                         Switching on/off specific baseline sections for RHEL9                               ##   
#================================================================================================================

# These variables govern whether the tasks of a particular section are to be executed when running the role.
# E.g: If you want to execute the tasks of Section 1 you should set the "_section1" variable to true.
# If you do not want the tasks from that section to get executed you simply set the variable to "false".
# Some sections support sub-section modularization. The super-section and sub-section must both be true
# for the sub-section to execute.
rhel9cis_section1: true
rhel9cis_section2: true
rhel9cis_section3: true
rhel9cis_section4: true
rhel9cis_section5: true
rhel9cis_section5_1: true
rhel9cis_section5_2: true
rhel9cis_section5_3: true
rhel9cis_section5_4: true
rhel9cis_section6: true
rhel9cis_section7: true


# These variables correspond with the CIS rule IDs or paragraph numbers defined in the CIS benchmark documents.
# PLEASE NOTE: 
# You must enable an entire section in order for the variables below to take effect.

## Section 1 Fixes
# Section 1 is Initial setup (FileSystem Configuration, Configure Software Updates, Filesystem Integrity Checking, Secure Boot Settings,
# Additional Process Hardening, Mandatory Access Control, Command Line Warning Banners, and GNOME Display Manager)

# Filesystem kernel modules
rhel9cis_rule_1_1_1_1: true  # Disable cramfs kernel module
rhel9cis_rule_1_1_1_2: true  # Disable freevxfs kernel module
rhel9cis_rule_1_1_1_3: true  # Disable hfs kernel module
rhel9cis_rule_1_1_1_4: true  # Disable hfsplus kernel module
rhel9cis_rule_1_1_1_5: true  # Disable jffs2 kernel module
rhel9cis_rule_1_1_1_6: true  # Disable squashfs kernel module
rhel9cis_rule_1_1_1_7: true  # Disable udf kernel module
rhel9cis_rule_1_1_1_8: true  # Disable usb-storage kernel module
rhel9cis_rule_1_1_1_9: true  # Disable firewire-core kernel module
rhel9cis_rule_1_1_1_10: true  # Ensure unused kernel file system modules are not available
# Filesystems
# /tmp
rhel9cis_rule_1_1_2_1_1: true  # Rule to ensure /tmp is a separate partition
rhel9cis_rule_1_1_2_1_2: true  # Ensure nodev option is set on /tmp partition if separate partition exists
rhel9cis_rule_1_1_2_1_3: true  # Ensure nosuid option is set on /tmp partition if separate partition exists
rhel9cis_rule_1_1_2_1_4: true  # Ensure noexec option is set on /tmp partition if separate partition exists
# /dev/shm
rhel9cis_rule_1_1_2_2_1: true  # Rule to ensure /dev/shm is a separate partition
rhel9cis_rule_1_1_2_2_2: true  # Ensure nodev option is set on /dev/shm partition if separate partition exists
rhel9cis_rule_1_1_2_2_3: true  # Ensure nosuid option is set on /dev/shm partition if separate partition exists
rhel9cis_rule_1_1_2_2_4: true  # Ensure noexec option is set on /dev/shm partition if separate partition exists
# /home
rhel9cis_rule_1_1_2_3_1: true  # Rule to ensure /home is a separate partition
rhel9cis_rule_1_1_2_3_2: true  # Ensure nodev option is set on /home partition if separate partition exists
rhel9cis_rule_1_1_2_3_3: true  # Ensure nosuid option is set on /home partition if separate partition exists
# /var
rhel9cis_rule_1_1_2_4_1: true  # Rule to ensure /var is a separate partition
rhel9cis_rule_1_1_2_4_2: true  # Ensure nodev option is set on /var partition if separate partition exists
rhel9cis_rule_1_1_2_4_3: true  # Ensure nosuid option is set on /var partition if separate partition exists
# /var/tmp
rhel9cis_rule_1_1_2_5_1: true  # Rule to ensure /var/tmp is a separate partition
rhel9cis_rule_1_1_2_5_2: true  # Ensure nodev option is set on /var/tmp partition if separate partition exists
rhel9cis_rule_1_1_2_5_3: true  # Ensure nosuid option is set on /var/tmp partition if separate partition exists
rhel9cis_rule_1_1_2_5_4: true  # Ensure noexec option is set on /var/tmp partition if separate partition exists 
# /var/log
rhel9cis_rule_1_1_2_6_1: true  # Rule to ensure /var/log is a separate partition
rhel9cis_rule_1_1_2_6_2: true  # Enable nodev option on /var/log partition if separate partition exists
rhel9cis_rule_1_1_2_6_3: true  # Enable nosuid option on /var/log partition if separate partition exists
rhel9cis_rule_1_1_2_6_4: true  # Enable noexec option on /var/log partition if separate partition exists
# /var/log/audit
rhel9cis_rule_1_1_2_7_1: true  # Rule to ensure /var/log/audit is a separate partition
rhel9cis_rule_1_1_2_7_2: true  # Enable nodev option on /var/log/audit partition if separate partition exists
rhel9cis_rule_1_1_2_7_3: true  # Enable nosuid option on /var/log/audit partition if separate partition exists
rhel9cis_rule_1_1_2_7_4: true  # Enable noexec option on /var/log/audit partition if separate partition exists
# Package Mgmt
# Config Pkg Repos
rhel9cis_rule_1_2_1_1: true  # Ensure RHEL GPG key is installed
rhel9cis_rule_1_2_1_2: true  # Ensure gpgcheck is globally enabled
rhel9cis_rule_1_2_1_3: true  # Ensure repo_gpgcheck is globally enabled
rhel9cis_rule_1_2_1_4: true  # Ensure package manager repositories are configured
# Package updates
rhel9cis_rule_1_2_2_1: true  # Update whole system with latest patches and security updates
# Selinux
rhel9cis_rule_1_3_1_1: true  # Ensure SELinux is installed
rhel9cis_rule_1_3_1_2: true  # Ensure SELinux is enabled in the bootloader configuration
rhel9cis_rule_1_3_1_3_5: true  # Merged rules from 1_3_1_3 to 1_3_1_5 into one rule to set selinux mode and policy
rhel9cis_rule_1_3_1_6: true  # Ensure no unconfined services exist
rhel9cis_rule_1_3_1_7: true  # Ensure MCS Translation Service (mcstrans) is not installed
rhel9cis_rule_1_3_1_8: true  # Ensure SETroubleshoot is not installed
# Bootloader
rhel9cis_rule_1_4_1: true  # Ensure bootloader password is set
rhel9cis_rule_1_4_2: true  # Ensure bootloader configuration file permissions are set
# Additional Process Hardening
rhel9cis_rule_1_5_1_2: true  # Configuring ASLR and ptrace_scope kernel params - IDs 1.5.1 and 1.5.2
rhel9cis_rule_1_5_3: true  # Ensure core dump backtraces are disabled
rhel9cis_rule_1_5_4: true  # Ensure core dump storage is disabled
# Config system wide Crypto
rhel9cis_rule_1_6_x: true   # Enables all 1.6.x rules by setting crypto policy to FUTURE and adding MIN-RSA module that allows 2048 bit keys (RSA,DH,DSA witch by default are set to 3072 bits in FUTURE policy)
# Command line warning banners
rhel9cis_rule_1_7_1: true  # Ensure message of the day is configured properly
rhel9cis_rule_1_7_2: true  # Ensure local login warning banner is configured properly
rhel9cis_rule_1_7_3: true  # Ensure remote login warning banner is configured properly
rhel9cis_rule_1_7_4: true  # Ensure permissions on /etc/motd are configured
rhel9cis_rule_1_7_5: true  # Ensure permissions on /etc/issue are configured
rhel9cis_rule_1_7_6: true  # Ensure permissions on /etc/issue.net are configured
# Gnome Display Manager - Run when using Gnome Desktop Environment
rhel9cis_rule_1_8_1: false
rhel9cis_rule_1_8_2: false
rhel9cis_rule_1_8_3: false
rhel9cis_rule_1_8_4: false
rhel9cis_rule_1_8_5: false
rhel9cis_rule_1_8_6: false
rhel9cis_rule_1_8_7: false
rhel9cis_rule_1_8_8: false
rhel9cis_rule_1_8_9: false
rhel9cis_rule_1_8_10: false

## Section 2 Fixes
# Section 2 rules are controlling Services (Special Purpose Services, and service clients)
# Configure Server Services
rhel9cis_rule_2_1_1: true  # Ensure autofs services are not in use
rhel9cis_rule_2_1_2: true  # Ensure avahi-daemon service is not in use
rhel9cis_rule_2_1_3: true  # Ensure dhcp server service is not in use
rhel9cis_rule_2_1_4: true  # Ensure dns server service is not in use 
rhel9cis_rule_2_1_5: true  # Ensure dnsmasq server service is not in use
rhel9cis_rule_2_1_6: true  # Ensure samba server service is not in use
rhel9cis_rule_2_1_7: true  # Ensure ftp server service is not in use
rhel9cis_rule_2_1_8: true  # Ensure message access server service is not in use
rhel9cis_rule_2_1_9: true  # Ensure nfs server services are not in use
rhel9cis_rule_2_1_10: true # Ensure nis server service is not in use
rhel9cis_rule_2_1_11: true # Ensure print server service is not in use
rhel9cis_rule_2_1_12: true # Ensure rpcbind server services are not in use
rhel9cis_rule_2_1_13: true # Ensure rsync services are not in use
rhel9cis_rule_2_1_14: true # Ensure snmp server service is not in use
rhel9cis_rule_2_1_15: true # Ensure telnet server service is not in use
rhel9cis_rule_2_1_16: true # Ensure tftp server service is not in use
rhel9cis_rule_2_1_17: true # Ensure web server service is not in use - nginx
rhel9cis_rule_2_1_18: true # Ensure web server service is not in use - httpd
rhel9cis_rule_2_1_19: true # Ensure xinetd service is not in use
rhel9cis_rule_2_1_20: true # Ensure x window server service is not in use
rhel9cis_rule_2_1_21: true # Ensure mail transfer agent is configured for local-only mode
rhel9cis_rule_2_1_22: true # Ensure only approved services are running
# Configure Client Services
rhel9cis_rule_2_2_1: true  # Ensure ftp client is not installed
rhel9cis_rule_2_2_2: true  # Ensure ldap client is not installed
rhel9cis_rule_2_2_3: true  # Ensure nis client is not installed
rhel9cis_rule_2_2_4: true  # Ensure telnet client is not installed
rhel9cis_rule_2_2_5: true  # Ensure TFTP client is not installed
# Configure Time Synchronization
# Rules 2.3.1 and 2.3.2 are covered in NTP configuration task file
rhel9cis_rule_2_3_3: true  # Ensure chrony is not run as the root user
# Job Schedulers
# cron
rhel9cis_rule_2_4_1_1: true  # Ensure cron daemon is enabled
rhel9cis_rule_2_4_1_2: true  # Ensure permissions on /etc/crontab are configured
rhel9cis_rule_2_4_1_3: true  # Ensure permissions on /etc/cron.hourly are configured
rhel9cis_rule_2_4_1_4: true  # Ensure permissions on /etc/cron.daily are configured
rhel9cis_rule_2_4_1_5: true  # Ensure permissions on /etc/cron.weekly are configured
rhel9cis_rule_2_4_1_6: true  # Ensure permissions on /etc/cron.monthly are configured
rhel9cis_rule_2_4_1_7: true  # Ensure permissions on /etc/cron.d are configured
rhel9cis_rule_2_4_1_8: true  # Ensure crontab is restricted to authorized users
# at
rhel9cis_rule_2_4_2_1: true  # Ensure at is restricted to authorized users

## Section 3 Fixes
# Section 3 rules are used for securely configuring the network configuration(kernel params, ACL, Firewall settings)
# Network Devices
rhel9cis_rule_3_1_1: true  # Disable ipv6 if not required
rhel9cis_rule_3_1_2: true  # Ensure wireless interfaces are disabled
rhel9cis_rule_3_1_3: true  # Ensure bluetooth services are not in use
# Network Kernel Modules
rhel9cis_rule_3_2_1: true  # Ensure dccp kernel module is not available 
rhel9cis_rule_3_2_2: true  # Ensure tipc kernel module is not available
rhel9cis_rule_3_2_3: true  # Ensure rds kernel module is not available
rhel9cis_rule_3_2_4: true  # Ensure sctp kernel module is not available
# Network Kernel Parameters
rhel9cis_rule_3_3_1: true  # Ensure IP forwarding is disabled
rhel9cis_rule_3_3_2: true  # Ensure packet redirect sending is disabled
rhel9cis_rule_3_3_3: true  # Ensure bogus ICMP responses are ignored
rhel9cis_rule_3_3_4: true  # Ensure broadcast ICMP requests are ignored
rhel9cis_rule_3_3_5: true  # Ensure ICMP redirects are not accepted
rhel9cis_rule_3_3_6: true  # Ensure secure ICMP redirects are not accepted
rhel9cis_rule_3_3_7: true  # Ensure Reverse Path Filtering is enabled
rhel9cis_rule_3_3_8: true  # Ensure source routed packets are not accepted
rhel9cis_rule_3_3_9: true  # Ensure suspicious packets are logged
rhel9cis_rule_3_3_10: true  # Ensure TCP SYN Cookies is enabled
rhel9cis_rule_3_3_11: true  # Ensure IPv6 router advertisements are not accepted

## Section 4 Fixes
# Section 4 rules are Logging and Auditing (Configure System Accounting (auditd),
# Configure Data Retention, and Configure Logging)
# Firewall utility
rhel9cis_rule_4_1_1: true # Ensure nftables is installed when rhel9cis_firewall == 'nftables'
rhel9cis_rule_4_1_2: true # Ensure a single firewall configuration utility is in use
# Configure firewalld
rhel9cis_rule_4_2_1: true # Ensure firewalld drops unnecessary services and ports
rhel9cis_rule_4_2_2: true # Ensure firewalld loopback traffic is configured
# Configure nftables
rhel9cis_rule_4_3_1: true # Ensure nftables base chains exist
rhel9cis_rule_4_3_2: true # Ensure nftables established connections are configured
rhel9cis_rule_4_3_3: true # Ensure nftables default deny firewall policy
rhel9cis_rule_4_3_4: true # Ensure nftables loopback traffic is configured

## Section 5 Fixes
# Section 5 rules control Access, Authentication, and Authorization (Configure time-based job schedulers,
# Configure sudo, Configure SSH Server, Configure PAM and User Accounts and Environment)
# Configure SSH Server
rhel9cis_rule_5_1_1: true
rhel9cis_rule_5_1_2: true
rhel9cis_rule_5_1_3: true
rhel9cis_rule_5_1_4: true
rhel9cis_rule_5_1_5: true
rhel9cis_rule_5_1_6: true
rhel9cis_rule_5_1_7: true
rhel9cis_rule_5_1_8: true
rhel9cis_rule_5_1_9: true
rhel9cis_rule_5_1_10: true
rhel9cis_rule_5_1_11: true
rhel9cis_rule_5_1_12: true
rhel9cis_rule_5_1_13: true
rhel9cis_rule_5_1_14: true
rhel9cis_rule_5_1_15: true
rhel9cis_rule_5_1_16: true
rhel9cis_rule_5_1_17: true
rhel9cis_rule_5_1_18: true
rhel9cis_rule_5_1_19: true
rhel9cis_rule_5_1_20: true
rhel9cis_rule_5_1_21: true
rhel9cis_rule_5_1_22: true
# 5.2 Configure Privilege Escalation
rhel9cis_rule_5_2_1: true
rhel9cis_rule_5_2_2: true
rhel9cis_rule_5_2_3: true
rhel9cis_rule_5_2_4: true
rhel9cis_rule_5_2_5: true
rhel9cis_rule_5_2_6: true
rhel9cis_rule_5_2_7: true
# 5.3.1.x Configure PAM software packages
rhel9cis_rule_5_3_1_1: true
rhel9cis_rule_5_3_1_2: true
rhel9cis_rule_5_3_1_3: true
# 5.3.2 Configure authselect
rhel9cis_rule_5_3_2_1: true
rhel9cis_rule_5_3_2_2: true
rhel9cis_rule_5_3_2_3: true
rhel9cis_rule_5_3_2_4: true
rhel9cis_rule_5_3_2_5: true
# 5.3.3.1 Configure pam_faillock module
rhel9cis_rule_5_3_3_1_1: true
rhel9cis_rule_5_3_3_1_2: true
rhel9cis_rule_5_3_3_1_3: true
# 5.3.3.2 Configure pam_pwquality module
rhel9cis_rule_5_3_3_2_1: true
rhel9cis_rule_5_3_3_2_2: true
rhel9cis_rule_5_3_3_2_3: true
rhel9cis_rule_5_3_3_2_4: true
rhel9cis_rule_5_3_3_2_5: true
rhel9cis_rule_5_3_3_2_6: true
rhel9cis_rule_5_3_3_2_7: true
rhel9cis_rule_5_3_3_2_8: true
# 5.3.3.3 Configure pam_pwhistory module
# These are added as part of 5.3.2.4 using jinja2 template
rhel9cis_rule_5_3_3_3_1: true
rhel9cis_rule_5_3_3_3_2: true
rhel9cis_rule_5_3_3_3_3: true
# 5.3.3.4 Configure pam_unix module
rhel9cis_rule_5_3_3_4_1: true
rhel9cis_rule_5_3_3_4_2: true
rhel9cis_rule_5_3_3_4_3: true
rhel9cis_rule_5_3_3_4_4: true
# 5.4 User Accounts and Environment
# 5.4.1 Configure shadow password suite parameters
rhel9cis_rule_5_4_1_1: true
rhel9cis_rule_5_4_1_2: true
rhel9cis_rule_5_4_1_3: true
rhel9cis_rule_5_4_1_4: true
rhel9cis_rule_5_4_1_5: true
rhel9cis_rule_5_4_1_6: true
# 5.4.2 Configure root and system accounts and environment
rhel9cis_rule_5_4_2_1: true
rhel9cis_rule_5_4_2_2: true
rhel9cis_rule_5_4_2_3: true
rhel9cis_rule_5_4_2_4: true
rhel9cis_rule_5_4_2_5: true
rhel9cis_rule_5_4_2_6: true
rhel9cis_rule_5_4_2_7: true
rhel9cis_rule_5_4_2_8: true
# 5.4.2 Configure user default environment
rhel9cis_rule_5_4_3_1: true
rhel9cis_rule_5_4_3_2: true
rhel9cis_rule_5_4_3_3: true

## Section 6 Fixes
# Section 6 rules control Logging and Auditing
# Configure Integrity Checking
rhel9cis_rule_6_1_1: true
rhel9cis_rule_6_1_2: true
rhel9cis_rule_6_1_3: true
# 6.2.1 Configure systemd-journald service
rhel9cis_rule_6_2_1_1: true
rhel9cis_rule_6_2_1_2: true
rhel9cis_rule_6_2_1_3: true
rhel9cis_rule_6_2_1_4: true
# 6.2.2.x Configure journald
rhel9cis_rule_6_2_2_1_1: true
rhel9cis_rule_6_2_2_1_2: true
rhel9cis_rule_6_2_2_1_3: true
rhel9cis_rule_6_2_2_1_4: true
rhel9cis_rule_6_2_2_2: true
rhel9cis_rule_6_2_2_3: true
rhel9cis_rule_6_2_2_4: true
# 6.2.3 Configure rsyslog
rhel9cis_rule_6_2_3_1: true
rhel9cis_rule_6_2_3_2: true
rhel9cis_rule_6_2_3_3: true
rhel9cis_rule_6_2_3_4: true
rhel9cis_rule_6_2_3_5: true
rhel9cis_rule_6_2_3_6: true
rhel9cis_rule_6_2_3_7: true
rhel9cis_rule_6_2_3_8: true
# 6.2.4 Configure Logfiles
rhel9cis_rule_6_2_4_1: true
# 6.3 Configure Auditing
# 6.3.1 Configure auditd Service
rhel9cis_rule_6_3_1_1: true
rhel9cis_rule_6_3_1_2: true
rhel9cis_rule_6_3_1_3: true
rhel9cis_rule_6_3_1_4: true
# 6.3.2 Configure Data Retention
rhel9cis_rule_6_3_2_1: true
rhel9cis_rule_6_3_2_2: true
rhel9cis_rule_6_3_2_3: true
rhel9cis_rule_6_3_2_4: true
# 6.3.3 Configure auditd Rules
rhel9cis_rule_6_3_3_1: true
rhel9cis_rule_6_3_3_2: true
rhel9cis_rule_6_3_3_3: true
rhel9cis_rule_6_3_3_4: true
rhel9cis_rule_6_3_3_5: true
rhel9cis_rule_6_3_3_6: true
rhel9cis_rule_6_3_3_7: true
rhel9cis_rule_6_3_3_8: true
rhel9cis_rule_6_3_3_9: true
rhel9cis_rule_6_3_3_10: true
rhel9cis_rule_6_3_3_11: true
rhel9cis_rule_6_3_3_12: true
rhel9cis_rule_6_3_3_13: true
rhel9cis_rule_6_3_3_14: true
rhel9cis_rule_6_3_3_15: true
rhel9cis_rule_6_3_3_16: true
rhel9cis_rule_6_3_3_17: true
rhel9cis_rule_6_3_3_18: true
rhel9cis_rule_6_3_3_19: true
rhel9cis_rule_6_3_3_20: true
rhel9cis_rule_6_3_3_21: true
# 6.3.4 Configure auditd File Access
rhel9cis_rule_6_3_4_1: true
rhel9cis_rule_6_3_4_2: true
rhel9cis_rule_6_3_4_3: true
rhel9cis_rule_6_3_4_4: true
rhel9cis_rule_6_3_4_5: true
rhel9cis_rule_6_3_4_6: true
rhel9cis_rule_6_3_4_7: true
rhel9cis_rule_6_3_4_8: true
rhel9cis_rule_6_3_4_9: true
rhel9cis_rule_6_3_4_10: true

## Section 7 Fixes
# Section 7 rules control System Maintenance
# System File Permissions
rhel9cis_rule_7_1_1: true
rhel9cis_rule_7_1_2: true
rhel9cis_rule_7_1_3: true
rhel9cis_rule_7_1_4: true
rhel9cis_rule_7_1_5: true
rhel9cis_rule_7_1_6: true
rhel9cis_rule_7_1_7: true
rhel9cis_rule_7_1_8: true
rhel9cis_rule_7_1_9: true
rhel9cis_rule_7_1_10: true
rhel9cis_rule_7_1_11: true
rhel9cis_rule_7_1_12: true
rhel9cis_rule_7_1_13: true
# 7.2 Local User and Group Settings
rhel9cis_rule_7_2_1: true
rhel9cis_rule_7_2_2: true
rhel9cis_rule_7_2_3: true
rhel9cis_rule_7_2_4: true
rhel9cis_rule_7_2_5: true
rhel9cis_rule_7_2_6: true
rhel9cis_rule_7_2_7: true
rhel9cis_rule_7_2_8: true
rhel9cis_rule_7_2_9: true

# --------------------------------------------------- End of sections switches ---------------------------------------------------------- #

## Control 1.8.x - Settings for GDM
# do not run Control 1.8.x if using a display manager different than gdm
rhel9cis_display_manager: "gdm"

# This variable governs whether rules dealing with GUI specific packages(and/or their settings) should
# be executed either to:
# - secure GDM, if GUI is needed('rhel9cis_gui: true')
# - or remove GDM and X-Windows-system, if no GUI is needed('rhel9cis_gui: false')
# The value of this variable is set automatically, if gnome is present this variable
# will always have `true` as a value, and `false` otherwise.
rhel9cis_gui: "{{ prelim_gnome_present.stat.exists | default(false) }}"

# This variable specifies the GNOME configuration database file to which configurations are written.
# (See "https://help.gnome.org/admin/system-admin-guide/stable/dconf-keyfiles.html.en")
# The default database is 'local'.
rhel9cis_dconf_db_name: local

# This variable  stores the content for the Warning Banner when Gnome GUI is used. 
rhel9cis_warning_banner: Authorized users only. All activity may be monitored and reported.

# This variable governs the number of seconds of inactivity before the screen goes blank.
# Set max value for idle-delay in seconds (between 1 and 900)
rhel9cis_screensaver_idle_delay: 900

# This variable governs the number of seconds the screen remains blank before it is locked.
# Set max value for lock-delay in seconds (between 0 and 5)
rhel9cis_screensaver_lock_delay: 5

###########################################

## Controls 2.1.x - Configure Server Services
# Set this variable to `true` to keep service `autofs`; otherwise, the service is uninstalled.
rhel9cis_autofs_services: false
# Set this variable to `true` to mask service `autofs`.
rhel9cis_autofs_mask: false
# Set this variable to `true` to keep service `avahi`; otherwise, the service is uninstalled.
rhel9cis_avahi_server: false
# Set this variable to `true` to mask service `avahi`.
rhel9cis_avahi_mask: false
# Set this variable to `true` to keep service `dhcp`; otherwise, the service is uninstalled.
rhel9cis_dhcp_server: false
# Set this variable to `true` to mask service `dhcp`.
rhel9cis_dhcp_mask: false
# Set this variable to `true` to keep service `dns`; otherwise, the service is uninstalled.
rhel9cis_dns_server: false
# Set this variable to `true` to mask service `dns`.
rhel9cis_dns_mask: false
# Set this variable to `true` to keep service `dnsmasq`; otherwise, the service is uninstalled.
rhel9cis_dnsmasq_server: false
# Set this variable to `true` to mask service `dnsmasq`.
rhel9cis_dnsmasq_mask: false
# Set this variable to `true` to keep service `samba`; otherwise, the service is uninstalled.
rhel9cis_samba_server: false
# Set this variable to `true` to mask service `samba`.
rhel9cis_samba_mask: false
# Set this variable to `true` to keep service `ftp`; otherwise, the service is uninstalled.
rhel9cis_ftp_server: false
# Set this variable to `true` to mask service `ftp`.
rhel9cis_ftp_mask: false
# Set this variable to `true` to keep service `message`; otherwise, the service is uninstalled.
rhel9cis_message_server: false  # This is for messaging dovecot and cyrus-imap
# Set this variable to `true` to mask service `message`.
rhel9cis_message_mask: false
# Set this variable to `true` to keep service `nfs`; otherwise, the service is uninstalled.
rhel9cis_nfs_server: true
# Set this variable to `true` to mask service `nfs`.
rhel9cis_nfs_mask: true
# Set this variable to `true` to keep service `nis`; otherwise, the service is uninstalled.
rhel9cis_nis_server: true  # set to mask if nis client required
# Set this variable to `true` to mask service `nis`.
rhel9cis_nis_mask: false
# Set this variable to `true` to keep service `print`; otherwise, the service is uninstalled.
rhel9cis_print_server: false  # replaces cups
# Set this variable to `true` to mask service `print`.
rhel9cis_print_mask: false
# Set this variable to `true` to keep service `rpc`; otherwise, the service is uninstalled.
rhel9cis_rpc_server: true
# Set this variable to `true` to mask service `rpc`.
rhel9cis_rpc_mask: true
# Set this variable to `true` to keep service `rsync`; otherwise, the service is uninstalled.
rhel9cis_rsync_server: false
# Set this variable to `true` to mask service `rsync`.
rhel9cis_rsync_mask: false
# Set this variable to `true` to keep service `snmp`; otherwise, the service is uninstalled.
rhel9cis_snmp_server: false
# Set this variable to `true` to mask service `snmp`.
rhel9cis_snmp_mask: false
# Set this variable to `true` to keep service `telnet`; otherwise, the service is uninstalled.
rhel9cis_telnet_server: false
# Set this variable to `true` to mask service `telnet`.
rhel9cis_telnet_mask: false
# Set this variable to `true` to keep service `tftp`; otherwise, the service is uninstalled.
rhel9cis_tftp_server: false
# Set this variable to `true` to mask service `tftp`.
rhel9cis_tftp_mask: false
# Set this variable to `true` to keep service `squid`; otherwise, the service is uninstalled.
rhel9cis_squid_server: false
# Set this variable to `true` to mask service `squid`.
rhel9cis_squid_mask: false
# Set this variable to `true` to keep service `httpd`; otherwise, the service is uninstalled.
rhel9cis_httpd_server: false
# Set this variable to `true` to mask service `httpd`.
rhel9cis_httpd_mask: false
# Set this variable to `true` to keep service `nginx`; otherwise, the service is uninstalled.
rhel9cis_nginx_server: false
# Set this variable to `true` to mask service `nginx`.
rhel9cis_nginx_mask: false
# Set this variable to `true` to keep service `xinetd`; otherwise, the service is uninstalled.
rhel9cis_xinetd_server: false
# Set this variable to `true` to mask service `xinetd`.
rhel9cis_xinetd_mask: false
# Set this variable to `true` to keep service `xwindow`; otherwise, the service is uninstalled.
rhel9cis_xwindow_server: false  # will remove mask not an option

## Control 2.1.21 - Ensure mail transfer agent is configured for local-only mode
# This variable if set to 'false', ensures that the mail transfer agent is configured for
# local-only mode.
rhel9cis_is_mail_server: false

## Section 2.2 Service clients

## Control - 2.2.1 - Ensure FTP client is not installed
# Set this variable to `true` to keep package `ftp`; otherwise, the package is uninstalled.
rhel9cis_ftp_client: false
## Control - 2.2.2 - Ensure LDAP client is not installed
# Set this variable to `true` to keep package `openldap-clients`; otherwise, the package is uninstalled.
rhel9cis_openldap_clients_required: false
## Control - 2.2.3 - Ensure nis client is not installed
# Set this variable to `true` to keep package `nis`(`ypbind`); otherwise, the package is uninstalled.
rhel9cis_ypbind_required: false
## Control - 2.2.4 - Ensure telnet client is not installed
# Set this variable to `true` to keep package `telnet`; otherwise, the package is uninstalled.
rhel9cis_telnet_required: false
## Control - 2.2.5 - Ensure tftp client is not installed
# Set this variable to `true` to keep package `tftp`; otherwise, the package is uninstalled.
rhel9cis_tftp_client: false

## Section 3 vars

## Control 3.1.1 - Ensure IPv6 status is identified
# This variable governs whether ipv6 is enabled or disabled.
rhel9cis_ipv6_required: true

## Control 3.1.2 - Ensure wireless interfaces are disabled
# if wireless adapter found allow network manager to be installed
rhel9cis_install_network_manager: false
# This variable holds the name of the network manager package, and it is used
# as a conditional to implement control 3.1.2. If the network manager package
# is present on the system then the control will be implemented!
rhel9cis_network_manager_package_name: NetworkManager

## Control 3.1.3 - Ensure bluetooth services are not in use
# Set this variable to `true` to keep service `bluetooth`; otherwise, the service is uninstalled.
rhel9cis_bluetooth_service: false
# Set this variable to `true` to mask service `bluetooth`.
rhel9cis_bluetooth_mask: false

## Controls 3.3.x System network parameters (host only OR host and router)
# This variable governs whether specific CIS rules
# concerned with acceptance and routing of packages are skipped.
rhel9cis_is_router: false

# This variable governs if the task which updates sysctl(including sysctl reload) is executed.
# NOTE: The current default value is likely to be overridden by other further tasks(via 'set_fact').
rhel9cis_sysctl_update: false
# This variable governs if the task which flushes the IPv4 routing table is executed(forcing subsequent connections to
# use the new configuration).
# NOTE: The current default value is likely to be overridden by other further tasks(via 'set_fact').
rhel9cis_flush_ipv4_route: false
# This variable governs if the task which flushes the IPv6 routing table is executed(forcing subsequent connections to
# use the new configuration).
# NOTE: The current default value is likely to be overridden by other further tasks(via 'set_fact').
rhel9cis_flush_ipv6_route: false

## Section 4 vars

### Firewall Service to install and configure - Options are:
# 1) either 'firewalld'
# 2) or 'nftables'
#### Some control allow for services to be removed or masked
#### The options are under each heading:
#### absent = remove the package
#### masked = leave package if installed and mask the service
rhel9cis_firewall: firewalld

## Controls 4.3.x
# This variable governs if a table will be automatically created in nftables. Without a table (no default one), nftables
# will not filter network traffic, so if this variable is set to 'false' and no tables exist, an alarm will be triggered!
rhel9cis_nft_tables_autonewtable: true
# This variable stores the name of the table to be used when configuring nftables(creating chains, configuring loopback
# traffic, established connections, default deny). If 'rhel9cis_nft_tables_autonewtable' is set as true, a new table will
# be created using as name the value stored by this variable.
rhel9cis_nft_tables_tablename: filter

## Control 4.3.1 - Ensure nftables base chains exist
# This variable governs if a nftables base chain(entry point for packets from the networking stack) will be automatically
# created, if needed. Without a chain, a hook for input, forward, and delete, packets that would flow through those
# chains will not be touched by nftables.
rhel9cis_nft_tables_autochaincreate: true

## Section 5 vars

## Section 5.1 - SSH

# This value, containing the absolute filepath of the produced 'sshd' config file, allows usage of
# drop-in files('/etc/ssh/ssh_config.d/{ssh_drop_in_name}.conf', supported by RHEL9) when CIS adopts them.
# Otherwise, the default value is '/etc/ssh/ssh_config'.
rhel9cis_sshd_config_file: /etc/ssh/sshd_config

## Control 5.1.7 - Ensure sshd access is configured
# (String) This variable, if specified, configures a list of GROUP name patterns, separated by spaces, to allow SSH access
# for users whose primary group or supplementary group list matches one of the patterns. This is done
# by setting the value of `AllowGroups` option in `/etc/ssh/sshd_config` file.
rhel9cis_sshd_allowgroups: "wheel"
## Control 5.1.7 - Ensure sshd access is configured
# This variable, if specified, configures a list of USER name patterns, separated by spaces, to prevent SSH access
# for users whose user name matches one of the patterns. This is done
# by setting the value of `DenyUsers` option in `/etc/ssh/sshd_config` file.
# If an USER@HOST format will be used, the specified user will be restricted only on that particular host.
rhel9cis_sshd_denyusers: "nobody"
## Control 5.1.7 - Ensure sshd access is configured
# This variable, if specified, configures a list of GROUP name patterns, separated by spaces,
# to prevent SSH access for users whose primary group or supplementary group list matches one of the patterns. This is done
# by setting the value of `DenyGroups` option in `/etc/ssh/sshd_config` file.
rhel9cis_sshd_denygroups: ""

## Control 5.1.9 - Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured
# This variable sets the maximum number of unresponsive "keep-alive" messages
# that can be sent from the server to the client before the connection is considered
# inactive and thus, closed.
rhel9cis_sshd_clientalivecountmax: 3
# This variable sets the time interval in seconds between sending "keep-alive"
# messages from the server to the client. These types of messages are intended to
# keep the connection alive and prevent it being terminated due to inactivity.
rhel9cis_sshd_clientaliveinterval: 15

## Control 5.1.10 - Ensure sshd DisableForwarding is enabled
# By Default this will also disablex11 forwarding
# set 'yes' if x11 is required this can be changed to run in /etc/ssh/ssh_config.d/50-redhat.conf
# This variable's value is used in the `/etc/ssh/ssh_config.d/50-redhat.conf` file to
# disable X11Forwarding. If X11 is required, set this variable's value to `yes`!
rhel9cis_sshd_x11forwarding: 'no'

## Control 5.1.14 - Ensure SSH LoginGraceTime is set to one minute or less
# This variable specifies the amount of seconds allowed for successful authentication to
# the SSH server.
rhel9cis_sshd_logingracetime: 60

## Control 5.1.15 - Ensure SSH LogLevel is appropriate
# This variable is used to control the verbosity of the logging produced by the SSH server.
# The options for setting it are as follows:
# - `QUIET`: Minimal logging;
# - `FATAL`: logs only fatal errors;
# - `ERROR`: logs error messages;
# - `INFO`: logs informational messages in addition to errors;
# - `VERBOSE`: logs a higher level of detail, including login attempts and key exchanges;
# - `DEBUG`: generates very detailed debugging information including sensitive information.
# - `DEBUG(x)`: Whereas x = debug level 1 to 3, DEBUG=DEBUG1.
rhel9cis_ssh_loglevel: INFO

## Control 5.1.16 - Ensure sshd MaxAuthTries is configured
# The MaxAuthTries parameter specifies the maximum number of authentication
# attempts permitted per connection. When the login failure count reaches half the
# number, error messages will be written to the syslog file detailing the login failure.
rhel9cis_ssh_maxauthtries: '4'

## Control 5.1.17 - Ensure sshd MaxStartups is configured
# The MaxStartups parameter specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.
rhel9cis_ssh_maxstartups: '10:30:60'

## Control 5.1.18 - Ensure sshd MaxSessions is configured
# This variable value specifies the maximum number of open sessions that are permitted from
# a given location. CIS recommends it to be 10 or less.
rhel9cis_ssh_maxsessions: 4

## Control 5.2.x - Ensure sudo log file exists
# By default, sudo logs through syslog(3). However, to specify a custom log file, the
# 'logfile' parameter will be used, setting it with current variable's value.
# This variable defines the path and file name of the sudo log file.
rhel9cis_sudolog_location: "/var/log/sudo.log"

## Control 5.2.4 - Ensure users must provide password for escalation
# The following variable specifies a list of users that should not be required to provide a password
# for escalation. Feel free to edit it according to your needs.
rhel9cis_sudoers_exclude_nopasswd_list:
  - ec2-user
  - vagrant

## Control 5.2.6 - Ensure sudo authentication timeout is configured correctly
# This variable sets the duration (in minutes) during which a user's authentication credentials
# are cached after successfully authenticating using "sudo". This allows the user to execute
# multiple commands with elevated privileges without needing to re-enter their password for each
# command within the specified time period. CIS requires a value of at most 15 minutes.
rhel9cis_sudo_timestamp_timeout: 15

## Control 5.2.7 - Ensure access to the 'su' command is restricted
# This variable determines the name of the group of users that are allowed to use the su command.
# CIS requires that such a group be CREATED(named according to site policy) and be kept EMPTY.
rhel9cis_sugroup: sugroup

## Controls 5.3.x PAM and Authselect
# Do not use authselect if:
# Your host is part of Linux Identity Management.
# Joining your host to an IdM domain with the ipa-client-install command automatically configures SSSD authentication on your host.
# Your host is part of Active Directory via SSSD.
# Calling the realm join command to join your host to an Active Directory domain automatically configures SSSD authentication on your host.
rhel9cis_allow_authselect_updates: true
## Control 5.3.1.2 - Ensure latest version of authselect is installed
# The following variables controls the implementation of control 5.3.1.2.
# If you want the latest version to be installed set this variable's value
# to `true`.
rhel9cis_authselect_pkg_update: false  # NOTE the risks if system is using SSSD or using ipa-client-install

## PAM AND Authselect

## Controls 5.3.x

# This variable configures the name of the custom profile to be created and selected.
# To be changed from default - cis_example_profile. This setting needs to be adjusted
# in order to minimise risk.
rhel9cis_authselect_custom_profile_name: cis_example_profile
# Name of the existing authselect profile to copy - options can be found with
# ```authselect list``` on the host to be configured
rhel9cis_authselect_default_profile_to_copy: "sssd --symlink-meta"

## Control 5.3.3.1.1 -
# This variable sets the amount of tries a password can be entered, before a user is locked.
rhel9cis_pam_faillock_deny: 5
## Control 5.3.3.2, 5.3.2.2
# This variable sets the amount of time a user will be unlocked after the max amount of
# password failures.
rhel9cis_pam_faillock_unlock_time: 900

## Control 5.3.3.1.3 - Ensure password failed attempts lockout includes root account
# This variable is used in the task that ensures that even the root account
# is included in the password failed attempts lockout measure.
# The following variable is used in the 'regexp' field. This field is used to find the
# line in the file. If the line matches the regular expression, it will be replaced
# with the line parameter's value.
rhel9cis_pamroot_lock_option: even_deny_root

## Control 5.3.3.2.1 - Ensure password number of changed characters is configured
# This variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure password number of changed characters is configured' control.
rhel9cis_passwd_difok_file: etc/security/pwquality.conf.d/50-pwdifok.conf  # pragma: allowlist secret
# This variable's value represents the minimum number of characters that must be different between
# the new password and the old password. It helps ensure that users don't create new passwords that
# are too similar to their previous ones, enhancing security. CIS states that this value should be at least 2.
rhel9cis_passwd_difok_value: 2

## Control 5.3.3.2.2 - Ensure minimum password length is configured
# This variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure minimum password length is configured' control.
rhel9cis_passwd_minlen_file: etc/security/pwquality.conf.d/50-pwlength.conf  # pragma: allowlist secret
# This variable specifies the minimum length that a password must  have to be considered valid.
# CIS states that this value should be at least 14.
rhel9cis_passwd_minlen_value: 14

## Control 5.3.3.2.3 - Ensure password complexity is configured
# The following variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure password complexity is configured' control.
rhel9cis_passwd_complex_file: etc/security/pwquality.conf.d/50-pwcomplexity.conf  # pragma: allowlist secret
# This variable holds the options for configuring the password complexity.
# Options supported are: 'minclass' or 'credits'.
rhel9cis_passwd_complex_option: minclass  # pragma: allowlist secret
# The following variable sets the password complexity via 'minclass'. The 'minclass' option provides
# the minimum number of classes of characters required in a new password. (digits, uppercase, lowercase, others). e.g.
# For example a value of 4 would mean that it requires digits, uppercase, lower case, and special characters.
rhel9cis_passwd_minclass: 4
# The following variables set the password complexity via the 'credits' option.
# Each of the variables represents a requirement for complexity.
# The 'dcredit' variable is the maximum credit for having digits in the new password.
# If less than 0 it is the minimum number of digits in the new password.
# e.g. dcredit = -1 requires at least one digit
rhel9cis_passwd_dcredit: -1
# The 'ucredit' variable is the maximum credit for having uppercase characters in the new password.
# If less than 0 it is the minimum number of uppercase characters in the new password.
# e.g. ucredit = -1 requires at least one uppercase character
rhel9cis_passwd_ucredit: -2
# The 'ocredit' variable is the maximum credit for having other characters in the new password.
# If less than 0 it is the minimum number of other characters in the new password.
# e.g. ocredit = -1 requires at least one special character
rhel9cis_passwd_ocredit: 0
# The 'lcredit' variable is the maximum credit for having lowercase characters in the new password.
# If less than 0 it is the minimum number of lowercase characters in the new password.
# e.g. lcredit = -1 requires at least one lowercase character
rhel9cis_passwd_lcredit: -2

## Control 5.3.3.2.4 - Ensure password same consecutive characters is configured
# This variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure password same consecutive characters is configured' control.
rhel9cis_passwd_maxrepeat_file: etc/security/pwquality.conf.d/50-pwrepeat.conf  # pragma: allowlist secret
# The following variable sets the maximum number of allowed same consecutive characters in a new password.
rhel9cis_passwd_maxrepeat_value: 3

## Control 5.3.3.2.5 - Ensure password maximum sequential characters is configured
# This variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure password maximum sequential characters is configured' control.
rhel9cis_passwd_maxsequence_file: etc/security/pwquality.conf.d/50-pwmaxsequence.conf  # pragma: allowlist secret
# The following variable sets the maximum length of monotonic character sequences in the new password.
# Examples of such sequence are '12345' or 'fedcb' . The check is disabled if the value is 0 .
rhel9cis_passwd_maxsequence_value: 3

## Control 5.3.3.2.6 - Ensure password dictionary check is enabled
# This variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure password dictionary check is enabled' control
rhel9cis_passwd_dictcheck_file: etc/security/pwquality.conf.d/50-pwdictcheck.conf  # pragma: allowlist secret
# The following variable's value sets whether to check for the words from the cracklib dictionary.
# When set to '1', this option enables dictionary checks, ensuring that passwords are not based on common
# dictionary words, which helps prevent users from choosing easily guessable passwords.
# When set to '0', dictionary checks are disabled. CIS states that it shall always be set to '1'.
rhel9cis_passwd_dictcheck_value: 1

# This variable is used in one of the config files to ensure password quality checking is enforced
rhel9cis_passwd_quality_enforce_value: 1

## Control 5.3.3.2.7 - Ensure password quality is enforced for the root user
# This variable holds the path to the configuration file that will be created (or overwritten if already existing)
# in order to implement the 'Ensure password quality is enforced for the root user' control.
rhel9cis_passwd_quality_enforce_root_file: etc/security/pwquality.conf.d/50-pwroot.conf  # pragma: allowlist secret
# The following variable enforces that the root user must adhere to the same password quality policies as other users.
rhel9cis_passwd_quality_enforce_root_value: enforce_for_root  # pragma: allowlist secret

## Control 5.3.3.3.1 - Ensure password history remember is configured
# This variable represents the number of password change cycles, after which
# a user can re-use a password. CIS requires a value of 24 or more.
rhel9cis_pamd_pwhistory_remember: 24

## Controls  5.3.3.4.3, 5.4.1.4
# The following variable's value represents the hashing algorithm used
rhel9cis_passwd_hash_algo: sha512  # pragma: allowlist secret

## Control 5.4.1.1 - Ensure password expiration is 365 days or less
# This variable governs after how many days a password expires.
# CIS requires a value of 365 or less.
rhel9cis_pass_max_days: 365
# The following variable allows the forcing of setting user_max_days for logins.
# This can break current connecting user access
rhel9cis_force_user_maxdays: false
## Control 5.4.1.2 - Ensure minimum days between password changes is 7 or more
# This variable specifies the minimum number of days allowed between changing
# passwords. CIS requires a value of at least 1.
rhel9cis_pass_min_days: 7
# The following variable allows the force setting of minimum days between changing the password
# This can break current connecting user access
rhel9cis_force_user_mindays: false
## Control 5.4.1.3 - Ensure password expiration warning days is 7 or more
# This variable governs, how many days before a password expires, the user will be warned.
# CIS requires a value of at least 7.
rhel9cis_pass_warn_age: 7
# The following variable allows the forcing of number of days before warning users of password expiry
# This can break current connecting user access
rhel9cis_force_user_warnage: false

## Control 5.4.1.5 - Ensure inactive password lock is configured
rhel9cis_inactivelock:
  # This variable specifies the number of days of inactivity before an account will be locked.
  # CIS requires a value of 30 days or less.
  lock_days: 30

## Control 5.4.1.6 - Ensure all users last password change date is in the past
# Allow ansible to expire password for account with a last changed date in the future. Setting it
# to 'false' will just display users in violation, while 'true' will expire those users passwords.
rhel9cis_futurepwchgdate_autofix: true

## Control 5.4.2.6 - Ensure root user umask is configured
# The following variable specifies the "umask" to configure for the root user.
# The user file-creation mode mask ( umask ) is used to determine the file
# permission for newly created directories and files. In Linux, the default
# permissions for any newly created directory is 0777 ( rwxrwxrwx ), and for
# any newly created file it is 0666 ( rw-rw-rw- ). The umask modifies the default
# Linux permissions by restricting (masking) these permissions. The umask is not
# simply subtracted, but is processed bitwise. Bits set in the umask are cleared
# in the resulting file mode. CIS recommends setting 'umask' to '0027' or more
# restrictive.
rhel9cis_root_umask: '0027'  # 0027 or more restrictive

## Control 5.4.2.7 - Ensure system accounts are secured | Set nologin
# The system users on this list are allowed to have a shell (e.g. applications
# that require a shell to function)
rhel9cis_system_users_shell: []

## Control 5.4.3.2 - Configuring user shell timeout
# This dictionary is related to ensuring the rule about user shell timeout
# This variable represents the amount of seconds a command or process is allowed to
# run before being forcefully terminated.
# CIS requires a value of at most 900 seconds.
rhel9cis_shell_session_timeout: 900
# This variable specifies the path of the timeout setting file.
# (TMOUT setting can be set in multiple files, but only one is required for the
# rule to pass. Options are:
# - a file in `/etc/profile.d/` ending in `.s`,
# - `/etc/profile`, or
# - `/etc/bash.bashrc`.
rhel9cis_shell_session_file: /etc/profile.d/tmout.sh

## Control 5.4.3.3 - Ensure default user umask is configured
# The following variable specifies the "umask" to set in the `/etc/bash.bashrc` and `/etc/profile`.
# The value needs to be `027` or more restrictive to comply with CIS standards.
rhel9cis_bash_umask: '0027'  # 0027 or more restrictive